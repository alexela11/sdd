<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SAFETY DEPOSIT DRAWER | Admin Login</title>

<!-- Supabase CDN -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
* {
  box-sizing: border-box;
  font-family: "Segoe UI", sans-serif;
}

body {
  min-height: 100vh;
  margin: 0;
  background:
    linear-gradient(
      135deg,
      rgba(15, 32, 39, 0.9),
      rgba(32, 58, 67, 0.9),
      rgba(44, 83, 100, 0.9)
    ),
    url("https://images.unsplash.com/photo-1526378722484-cc5c51092d5b");
  background-size: cover;
  background-position: center;
  display: flex;
  justify-content: center;
  align-items: center;
}

.container {
  width: 360px;
  padding: 35px;
  border-radius: 18px;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.3);
  box-shadow: 0 10px 40px rgba(0,0,0,0.4);
  color: #fff;
  text-align: center;
}

.logo-wrapper img {
  width: 90px;
  margin-bottom: 15px;
}

h2 {
  margin-bottom: 20px;
  font-weight: 600;
}

.input-group {
  text-align: left;
  margin-bottom: 15px;
}

label {
  font-size: 0.85rem;
  color: rgba(255,255,255,0.8);
}

input {
  width: 100%;
  padding: 11px;
  margin-top: 5px;
  border-radius: 10px;
  background: rgba(255,255,255,0.15);
  border: 1px solid rgba(255,255,255,0.35);
  color: #fff;
  outline: none;
}

input::placeholder {
  color: rgba(255,255,255,0.6);
}

button {
  width: 100%;
  padding: 12px;
  margin-top: 15px;
  border-radius: 10px;
  border: none;
  background: rgba(255,255,255,0.3);
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  transition: 0.3s;
}

button:hover {
  background: rgba(255,255,255,0.45);
}

.error-msg {
  display: none;
  margin-top: 10px;
  font-size: 0.85rem;
  color: #ffb3b3;
}

.link {
  display: block;
  margin-top: 15px;
  font-size: 0.85rem;
  color: rgba(255,255,255,0.8);
  text-decoration: none;
}

.link:hover {
  text-decoration: underline;
}
</style>
</head>

<body>

<div class="container">
  <div class="logo-wrapper">
    <img src="sdd-logo.png" alt="SDD Logo">
  </div>

  <h2>Admin Login</h2>

  <div class="input-group">
    <label>Username</label>
    <input id="username" type="text" placeholder="Enter username">
  </div>

  <div class="input-group">
    <label>Password</label>
    <input id="password" type="password" placeholder="Enter password">
  </div>

  <button id="loginBtn">Login</button>

  <p id="errorMsg" class="error-msg">
    Username or Password is Incorrect.
  </p>

  <a class="link" href="admin-register.html">Don't have an account?</a>
</div>

<script>
/* ==============================
   SUPABASE CONFIG (FIXED)
   ============================== */

/* ðŸ”´ PASTE YOUR REAL ANON PUBLIC KEY HERE */
const SUPABASE_URL = "https://fiiflkakeaorglvqyjxx.supabase.co";
const SUPABASE_ANON_KEY = "PASTE_YOUR_ANON_PUBLIC_KEY_HERE";

/* Create client WITH API KEY */
const db = supabase.createClient(
  SUPABASE_URL,
  SUPABASE_ANON_KEY
);

/* ==============================
   PASSWORD HASH
   ============================== */
async function hashPassword(password) {
  const enc = new TextEncoder();
  const data = enc.encode(password);
  const hash = await crypto.subtle.digest("SHA-256", data);
  return Array.from(new Uint8Array(hash))
    .map(b => b.toString(16).padStart(2, "0"))
    .join("");
}

/* ==============================
   LOGIN FUNCTION
   ============================== */
async function loginAdmin() {
  errorMsg.style.display = "none";

  const usernameVal = username.value.trim();
  const passwordVal = password.value;

  if (!usernameVal || !passwordVal) {
    alert("Fill all fields");
    return;
  }

  const password_hash = await hashPassword(passwordVal);

  const { data, error } = await db
    .from("admin_accounts")
    .select("*")
    .eq("username", usernameVal)
    .eq("password_hash", password_hash)
    .single();

  if (error || !data) {
    errorMsg.style.display = "block";
    return;
  }

  localStorage.setItem("admin", JSON.stringify(data));
  window.location.href = "index.html";
}

loginBtn.addEventListener("click", loginAdmin);

/* ENTER KEY SUPPORT */
document.addEventListener("keydown", e => {
  if (e.key === "Enter") loginAdmin();
});
</script>

</body>
</html>













